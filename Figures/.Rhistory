library(ggplot2)
library(latex2exp)
library(extrafont)
library(patchwork)
colnames<-c('day','cases')
empirical <- read.table('/home/fra/Projects/DSA_inference/foot_and_mouth/empirical_density_foot_and_mouth.txt',col.names=colnames)
fitempirical <- read.table('/home/fra/Projects/DSA_inference/foot_and_mouth/fit_empirical_density_foot_and_mouth.txt',col.names=colnames)
library(gghighlight)
real_cases <- read.table("/home/fra/Projects/DSA_inference/foot_and_mouth/processed_time_daily_cases.txt",col.names=colnames)
ggplot(real_cases, aes(x=day),color='black')  +
labs(x = 'time (days)', y = "daily new cases")+
geom_point(aes(y=cases),size=2,colour=(rgb(163/255,35/255,142/255))) +
gghighlight(day<84,unhighlighted_params = list(color='black'))+
theme_bw()+
theme(text=element_text(size=12, family="LM Roman 10"), axis.line = element_line(colour = rgb(163/255,35/255,142/255),
size = 1, linetype = "solid", ),  panel.border = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_continuous(expand = expansion(mult = c(0, .1)))+
scale_x_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks(n = 5))
ggplot(empirical, aes(x=day))  +
labs(x = 'time', y = "empirical density")+
geom_point(aes(y=cases),size=2,colour=(rgb(163/255,35/255,142/255))) +
theme(axis.line = element_line(colour = rgb(163/255,35/255,142/255),
size = 1, linetype = "solid", ),  panel.border = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_continuous(expand = expansion(mult = c(0, .1)))+
scale_x_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks(n = 5))+
geom_line(data=fitempirical,aes(y=fitempirical$cases),size=2,colour="black")
colnames<-c('time','weib','gamma')
x_lower <- 0
x_upper <- 20
shape_gam = (4.97839683e+00)**2/1.08327439e+01
scale_gam = 1.08327439e+01/(4.97839683e+00)
max_height <- max(dweibull(x_lower:x_upper, shape = 2.13623063e+00, scale=4.75098558e+00, log = FALSE))+0.1
ggplot(data.frame(x = c(x_lower, x_upper)), aes(x = x)) + xlim(x_lower, x_upper) +
ylim(0, max_height) +
theme_bw()+
stat_function(fun = dweibull, args = list(shape = 2.13623063e+00, scale=4.75098558e+00), size=2, aes(colour="orange")) +
stat_function(fun = dgamma, args = list(shape = shape_gam , scale=scale_gam),size=2, aes(colour="blue"))+
labs(x = "\n time (days)", y = "pdf \n") +
theme(text=element_text(size=12, family="LM Roman 10"), axis.line = element_line(colour = rgb(163/255,35/255,142/255),
size = 1, linetype = "solid", ),  panel.border = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position = c(0.8,0.6))+
scale_y_continuous(expand = expansion(mult = c(0, .1)))+
scale_x_continuous(expand = expansion(mult = c(0, .1)), breaks = scales::pretty_breaks(n = 5))+
scale_colour_manual(values=c("orange","blue"),labels=c("Infectiousness", "Removal time"), name="Distributions")
